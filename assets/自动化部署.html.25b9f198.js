import{_ as o,r as i,o as d,c as r,b as e,d as n,a as t,e as s}from"./app.f22e8cd8.js";const c="/assets/auth1.e17aa2fd.png",p="/assets/auth2.f41e6a12.png",l={},h=t('<h1 id="\u5229\u7528git-hooks\u5B9E\u73B0\u81EA\u52A8\u5316\u90E8\u7F72" tabindex="-1"><a class="header-anchor" href="#\u5229\u7528git-hooks\u5B9E\u73B0\u81EA\u52A8\u5316\u90E8\u7F72" aria-hidden="true">#</a> \u5229\u7528git hooks\u5B9E\u73B0\u81EA\u52A8\u5316\u90E8\u7F72</h1><h2 id="\u4E00\u822C\u60C5\u51B5\u4E0B\u7684\u524D\u7AEF\u90E8\u7F72" tabindex="-1"><a class="header-anchor" href="#\u4E00\u822C\u60C5\u51B5\u4E0B\u7684\u524D\u7AEF\u90E8\u7F72" aria-hidden="true">#</a> \u4E00\u822C\u60C5\u51B5\u4E0B\u7684\u524D\u7AEF\u90E8\u7F72</h2><p>\u9996\u5148\u8BA9\u6211\u4EEC\u5148\u8FDB\u5165\u65F6\u7A7A\u88C2\u7F1D\uFF0C\u56DE\u5230\u5341\u51E0\u5E74\u524D\u524D\u7AEF\u5F00\u53D1\u6700\u539F\u59CB\u7684\u9636\u6BB5\u3002</p><p>\u6211\u4EEC\u624B\u5199\u4E86\u4E00\u4E2Ahtml\u6587\u4EF6\u548Ccss\u7684\u6837\u5F0F\u6587\u4EF6\uFF0C\u7136\u540E\u628A\u5B83\u4EEC\u653E\u8FDB\u4E00\u4E2A\u540D\u4E3Adist\u7684\u6587\u4EF6\u5939\u5185\uFF0C\u628A\u6574\u4E2A\u6587\u4EF6\u5939\u4E22\u5230\u670D\u52A1\u5668\u4E0A\uFF0C\u7136\u540E\u5F00\u542FNginx\uFF0C\u6307\u5411dist\u6587\u4EF6\u5939\uFF0C\u7B49\u5F85\u7528\u6237\u8BBF\u95EE\u3002\u4EE5\u4E0A\u5C31\u662F\u6700\u57FA\u7840\u7684\u524D\u7AEF\u90E8\u7F72\u3002</p><img src="'+c+'" alt="image" style="zoom:50%;"><p>\u5F53\u6211\u4EEC\u7684\u9879\u76EE\u590D\u6742\u8D77\u6765\u540E\uFF0C\u6211\u4EEC\u53EF\u80FD\u4F1A\u501F\u52A9wepack\u6765\u6A21\u5757\u5316\u6253\u5305\u6210bundle\uFF0C\u6216\u8005\u7528Vue/React\u6765\u5F00\u53D1\u7684\u524D\u7AEF\u9879\u76EE\u7684\u8BDD\uFF0C\u5F00\u5B8C\u5B8C\u6BD5\u4E4B\u540E\u4F1A\u7528npm run build/yarn build\u6765\u5B8C\u6210\u8FD9\u4E00\u76EE\u7684\uFF0C\u6700\u540E\u5C06\u6784\u5EFA\u540E\u7684dist\u6587\u4EF6\u5939\u540C\u6837\u4E22\u5230\u670D\u52A1\u5668\u4E0A\u6765\u5B8C\u6210\u524D\u7AEF\u90E8\u7F72\u3002</p><p>\u90A3\u4E48\u95EE\u9898\u6765\u4E86\uFF0C\u5728\u6211\u4EEC\u6BCF\u5F00\u53D1\u5B8C\u4E00\u4E2Afeature\uFF0C\u628A\u4EE3\u7801push\u5230\u4E0A\u53BB\u4E4B\u540E\uFF0C\u5982\u679C\u8981\u5728\u5F00\u53D1\u73AF\u5883\u67E5\u770B\u6548\u679C\uFF0C\u96BE\u9053\u4E5F\u8981\u624B\u52A8build\u4E00\u6B21\u548C\u628Adist\u6587\u4EF6\u5939\u62F7\u8D1D\u8FC7\u53BB\uFF1F\u73B0\u5728\u6211\u4EEC\u4E00\u822C\u90FD\u91C7\u7528Git\u6765\u7BA1\u7406\u4EE3\u7801\uFF0C\u5BF9\u4E8E\u591A\u4EBA\u5F00\u53D1\u534F\u4F5C\u6A21\u5F0F\u7684\u60C5\u51B5\u4E0B\uFF0C\u6211\u4EEC\u4F1A\u5728\u5DF2\u6709\u5206\u652F\uFF08master/dev\uFF09\u4E0B\u521B\u5EFA\u51FA\u81EA\u5DF1\u7684\u5F00\u53D1\u5206\u652F\uFF0C\u672C\u5730\u5F00\u53D1\u6D4B\u8BD5\u540E\u518D\u5408\u5E76\u5230master/dev\u5206\u652F\u3002<strong>\u90A3\u4E48\u6709\u6CA1\u6709\u4E00\u79CD\u65B9\u5F0F\u53EF\u4EE5\u505A\u5230\uFF0C\u6BCF\u6B21\u6211\u4EECpush\u6700\u65B0\u7684\u4EE3\u7801\u4E0A\u53BB\u540E\uFF0C\u670D\u52A1\u5668\u5C31\u81EA\u52A8\u5B89\u88C5\u4F9D\u8D56\uFF0C\u6784\u5EFA\u4E43\u81F3\u91CD\u542F\u670D\u52A1\u5462\uFF1F</strong></p><h2 id="\u5229\u7528git-hooks\u5B9E\u73B0\u81EA\u52A8\u5316\u90E8\u7F72-1" tabindex="-1"><a class="header-anchor" href="#\u5229\u7528git-hooks\u5B9E\u73B0\u81EA\u52A8\u5316\u90E8\u7F72-1" aria-hidden="true">#</a> \u5229\u7528git hooks\u5B9E\u73B0\u81EA\u52A8\u5316\u90E8\u7F72</h2><p>\u5176\u5B9E\uFF0C\u5F53\u4F60\u7528 <code>git init</code> \u521D\u59CB\u5316\u4E00\u4E2A\u65B0\u7248\u672C\u5E93\u65F6\uFF0CGit \u9ED8\u8BA4\u4F1A\u5728\u8FD9\u4E2A\u76EE\u5F55\u4E2D\u653E\u7F6E\u4E00\u4E9B\u793A\u4F8B\u811A\u672C\u3002 \u8FD9\u4E9B\u811A\u672C\u9664\u4E86\u672C\u8EAB\u53EF\u4EE5\u88AB\u8C03\u7528\u5916\uFF0C\u5B83\u4EEC\u8FD8\u900F\u9732\u4E86\u88AB\u89E6\u53D1\u65F6\u6240\u4F20\u5165\u7684\u53C2\u6570\u3002 \u6240\u6709\u7684\u793A\u4F8B\u90FD\u662F shell \u811A\u672C\uFF0C\u5176\u4E2D\u4E00\u4E9B\u8FD8\u6DF7\u6742\u4E86 Perl \u4EE3\u7801\uFF0C\u4E0D\u8FC7\uFF0C\u4EFB\u4F55\u6B63\u786E\u547D\u540D\u7684\u53EF\u6267\u884C\u811A\u672C\u90FD\u53EF\u4EE5\u6B63\u5E38\u4F7F\u7528 \u2014\u2014 \u4F60\u53EF\u4EE5\u7528 Ruby \u6216 Python\uFF0C\u6216\u4EFB\u4F55\u4F60\u719F\u6089\u7684\u8BED\u8A00\u7F16\u5199\u5B83\u4EEC\u3002 \u8FD9\u4E9B\u793A\u4F8B\u7684\u540D\u5B57\u90FD\u662F\u4EE5 <code>.sample</code> \u7ED3\u5C3E\uFF0C\u5982\u679C\u4F60\u60F3\u542F\u7528\u5B83\u4EEC\uFF0C\u5F97\u5148\u79FB\u9664\u8FD9\u4E2A\u540E\u7F00\u3002</p><img src="'+p+'" alt="image" style="zoom:70%;"><p>\u8FD9\u91CC\u4E3B\u8981\u4ECB\u7ECD\u4E24\u4E2A\u94A9\u5B50\uFF0C\u5B98\u65B9\u5730\u5740\uFF1Ahttp://git-scm.com/docs/githooks</p><h3 id="post-update" tabindex="-1"><a class="header-anchor" href="#post-update" aria-hidden="true">#</a> post-update</h3>',12),u=s("This hook is invoked by [git-receive-pack"),m={href:"http://git-scm.com/docs/git-receive-pack",target:"_blank",rel:"noopener noreferrer"},g=s("1]"),b=s(" when it reacts to "),v=e("code",null,"git push",-1),k=s(" and updates reference(s) in its repository. It executes on the remote repository once after all the refs have been updated."),_=e("p",null,"It takes a variable number of parameters, each of which is the name of ref that was actually updated.",-1),f=e("p",null,[s("This hook is meant primarily for notification, and cannot affect the outcome of "),e("code",null,"git receive-pack"),s(".")],-1),y=s("The post-update hook can tell what are the heads that were pushed, but it does not know what their original and updated values are, so it is a poor place to do log old..new. The "),w={href:"http://git-scm.com/docs/githooks#post-receive",target:"_blank",rel:"noopener noreferrer"},x=s("post-receive"),T=s(" hook does get both original and updated values of the refs. You might consider it instead if you need them."),q=e("p",null,[s("When enabled, the default post-update hook runs "),e("code",null,"git update-server-info"),s(" to keep the information used by dumb transports (e.g., HTTP) up to date. If you are publishing a Git repository that is accessible via HTTP, you should probably enable this hook.")],-1),I=e("p",null,[s("Both standard output and standard error output are forwarded to "),e("code",null,"git send-pack"),s(" on the other end, so you can simply "),e("code",null,"echo"),s(" messages for the user.")],-1),G=t(`<p>\u7B80\u5355\u6765\u8BF4\uFF0C\u8FD9\u4E2A\u94A9\u5B50\u4F1A\u5728\u6211\u4EEC\u6267\u884C<code>git push</code>\u5C06\u4EE3\u7801\u63A8\u5230git\u4ED3\u5E93\uFF0C\u4EE3\u7801\u66F4\u65B0\u4E4B\u540E\u6267\u884C\u3002\u540C\u65F6\u643A\u5E26\u4E86\u5F53\u524D\u7684ref\u4F5C\u4E3A\u53C2\u6570\u3002</p><p>\u6BD4\u5982\u8BF4\uFF0C\u6211\u4EEC\u5728post-update\u4E2D\u7F16\u5199\u811A\u672C</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/sh</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5047\u8BBE\u6211\u4EEC\u5F53\u524D\u5904\u4E8Edev\u5206\u652F\uFF0C\u90A3\u4E48\u5F53\u6211\u4EEC\u6267\u884C<code>git push origin dev</code>\u4E4B\u540E\uFF0C\u4F1A\u8F93\u51FA\u201Crefs/heads/dev\u201D\u3002</p><p>\u6548\u679C\u7B49\u540C\u4E8E</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> push origin dev
<span class="token function">sh</span> <span class="token variable">\${path}</span>/.git/hooks/post-update refs/heads/dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6240\u4EE5\u6211\u4EEC\u53EF\u4EE5\u5728\u8FD9\u4E2A\u94A9\u5B50\u811A\u672C\u4E2D\u6267\u884C\u8FDE\u63A5\u9879\u76EE\u6240\u5728\u7684\u670D\u52A1\u5668\uFF0C\u6839\u636E\u5206\u652F\u53BB\u62C9\u53D6\u76F8\u5E94\u6700\u65B0\u4EE3\u7801\u7B49\u64CD\u4F5C</p><h3 id="post-merge" tabindex="-1"><a class="header-anchor" href="#post-merge" aria-hidden="true">#</a> post-merge</h3>`,8),N=s("This hook is invoked by [git-merge"),V={href:"http://git-scm.com/docs/git-merge",target:"_blank",rel:"noopener noreferrer"},B=s("1]"),P=s(", which happens when a "),R=e("code",null,"git pull",-1),$=s(" is done on a local repository. The hook takes a single parameter, a status flag specifying whether or not the merge being done was a squash merge. This hook cannot affect the outcome of "),E=e("code",null,"git merge",-1),L=s(" and is not executed, if the merge failed due to conflicts."),S=e("p",null,"This hook can be used in conjunction with a corresponding pre-commit hook to save and restore any form of metadata associated with the working tree (e.g.: permissions/ownership, ACLS, etc). See contrib/hooks/setgitperms.perl for an example of how to do this.",-1),z=t(`<p>\u7B80\u5355\u6765\u8BF4\uFF0C\u8FD9\u4E2A\u94A9\u5B50\u7531git-merge\u8C03\u7528\uFF0C\u56E0\u6B64\u5F53\u6211\u4EEC\u5728\u672C\u5730\u6267\u884C<code>git pull</code>\u4E4B\u540E\u4E5F\u4F1A\u8C03\u7528\uFF0C\u5982\u679C\u7531\u4E8E\u51B2\u7A81\u5BFC\u81F4\u5408\u5E76\u5931\u8D25\uFF0C\u90A3\u4E48\u8FD9\u4E2A\u94A9\u5B50\u5219\u4E0D\u4F1A\u88AB\u8C03\u7528</p><p>\u90A3\u4E48\u6211\u4EEC\u5C31\u53EF\u4EE5\u5728\u8FD9\u4E2A\u94A9\u5B50\u811A\u672C\u4E2D\u6267\u884C\u5B89\u88C5\u6A21\u5757\uFF0C\u6784\u5EFA\uFF0C\u62F7\u8D1D\u6587\u4EF6\u7B49\u64CD\u4F5C</p><h3 id="\u5B9E\u8DF5" tabindex="-1"><a class="header-anchor" href="#\u5B9E\u8DF5" aria-hidden="true">#</a> \u5B9E\u8DF5</h3><p>\u5229\u7528post-update\u4EE5\u53CApost-merge\u4E24\u4E2A\u94A9\u5B50\uFF0C\u6211\u4EEC\u5C31\u53EF\u4EE5\u5B9E\u73B0\u81EA\u52A8\u5316\u90E8\u7F72\u4E86\u3002</p><h4 id="\u5728git\u670D\u52A1\u5668\u7684\u9879\u76EE\u4EE3\u7801\u4ED3\u5E93\u4E2D\u7F16\u5199post-update\u94A9\u5B50\u811A\u672C" tabindex="-1"><a class="header-anchor" href="#\u5728git\u670D\u52A1\u5668\u7684\u9879\u76EE\u4EE3\u7801\u4ED3\u5E93\u4E2D\u7F16\u5199post-update\u94A9\u5B50\u811A\u672C" aria-hidden="true">#</a> \u5728git\u670D\u52A1\u5668\u7684\u9879\u76EE\u4EE3\u7801\u4ED3\u5E93\u4E2D\u7F16\u5199post-update\u94A9\u5B50\u811A\u672C</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/sh</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$1</span> <span class="token operator">==</span> <span class="token string">&quot;refs/heads/dev&quot;</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
  <span class="token builtin class-name">unset</span> GIT_DIR <span class="token comment"># \u5982\u679C\u9879\u76EE\u5728\u672C\u673A\uFF0C\u9700\u8981\u5148unset GIT_DIR\uFF0C\u5426\u5219\u5C06\u4F1A\u56E0\u8DEF\u5F84\u95EE\u9898\u62A5\u9519</span>
  <span class="token builtin class-name">cd</span> /home/fe  <span class="token comment"># \u8FDB\u5165\u5230\u5F00\u53D1\u73AF\u5883\u9879\u76EE\u8DEF\u5F84\uFF0C\u5047\u8BBE\u5F00\u53D1\u73AF\u5883\u4E5F\u5728\u672C\u673A\uFF0C\u8DEF\u5F84\u4E3A/home/fe</span>
  <span class="token function">git</span> pull origin dev
<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$1</span> <span class="token operator">==</span> <span class="token string">&quot;refs/heads/master&quot;</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
    <span class="token comment"># \u8FDB\u5165\u5230master\u73AF\u5883\uFF0C\u5047\u8BBEmaster\u73AF\u5883\u9700\u8981\u8FDC\u7A0B\u767B\u9646,\u8D26\u53F7\u4E3Amaster,ip\u4E3A192.168.1.10,\u9879\u76EE\u8DEF\u5F84\u5728/home/fe\u4E0B</span>
  <span class="token function">ssh</span> master@192.168.1.10 <span class="token string">&quot;cd &#39;/home/fe&#39; &amp;&amp; git pull origin master&quot;</span>
<span class="token keyword">fi</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5728\u9879\u76EE\u6240\u5728\u7684\u670D\u52A1\u5668\u7F16\u5199post-merge\u94A9\u5B50\u811A\u672C" tabindex="-1"><a class="header-anchor" href="#\u5728\u9879\u76EE\u6240\u5728\u7684\u670D\u52A1\u5668\u7F16\u5199post-merge\u94A9\u5B50\u811A\u672C" aria-hidden="true">#</a> \u5728\u9879\u76EE\u6240\u5728\u7684\u670D\u52A1\u5668\u7F16\u5199post-merge\u94A9\u5B50\u811A\u672C</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/sh</span>

<span class="token function">yarn</span> <span class="token comment"># \u5B89\u88C5\u4F9D\u8D56</span>
<span class="token function">yarn</span> build <span class="token comment"># \u6784\u5EFA\u9879\u76EE</span>
<span class="token function">cp</span> <span class="token parameter variable">-rpv</span> dist/* dest <span class="token comment">#\u62F7\u8D1D\u6587\u4EF6\u5230dest\u6587\u4EF6\u5939\u4E0B\uFF0C\u907F\u514D\u6784\u5EFA\u65F6\u5F71\u54CD\u65E7\u7CFB\u7EDF</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u8FD9\u6837\u6BCF\u6B21\u5F53push\u4EE3\u7801\u5230git\u4ED3\u5E93\u540E-post-update\u94A9\u5B50\u811A\u672C\u5C31\u4F1A\u6267\u884C-\u8FDB\u5165\u5230\u9879\u76EE\u6240\u5728\u670D\u52A1\u5668-\u8DEF\u5F84\u81EA\u52A8\u6267\u884Cgit-pull\u64CD\u4F5C-\u800C\u6267\u884C\u5B8C\u6BD5\u4E4B\u540E-post-merge\u94A9\u5B50\u811A\u672C\u53C8\u4F1A\u88AB\u8C03\u7528-\u7136\u540E\u8FDB\u884C\u5B89\u88C5\u4F9D\u8D56-\u6784\u5EFA\u7B49\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#\u8FD9\u6837\u6BCF\u6B21\u5F53push\u4EE3\u7801\u5230git\u4ED3\u5E93\u540E-post-update\u94A9\u5B50\u811A\u672C\u5C31\u4F1A\u6267\u884C-\u8FDB\u5165\u5230\u9879\u76EE\u6240\u5728\u670D\u52A1\u5668-\u8DEF\u5F84\u81EA\u52A8\u6267\u884Cgit-pull\u64CD\u4F5C-\u800C\u6267\u884C\u5B8C\u6BD5\u4E4B\u540E-post-merge\u94A9\u5B50\u811A\u672C\u53C8\u4F1A\u88AB\u8C03\u7528-\u7136\u540E\u8FDB\u884C\u5B89\u88C5\u4F9D\u8D56-\u6784\u5EFA\u7B49\u64CD\u4F5C" aria-hidden="true">#</a> \u8FD9\u6837\u6BCF\u6B21\u5F53push\u4EE3\u7801\u5230git\u4ED3\u5E93\u540E\uFF0Cpost-update\u94A9\u5B50\u811A\u672C\u5C31\u4F1A\u6267\u884C\uFF0C\u8FDB\u5165\u5230\u9879\u76EE\u6240\u5728\u670D\u52A1\u5668/\u8DEF\u5F84\u81EA\u52A8\u6267\u884C<code>git pull</code>\u64CD\u4F5C\uFF0C\u800C\u6267\u884C\u5B8C\u6BD5\u4E4B\u540E\uFF0Cpost-merge\u94A9\u5B50\u811A\u672C\u53C8\u4F1A\u88AB\u8C03\u7528\uFF0C\u7136\u540E\u8FDB\u884C\u5B89\u88C5\u4F9D\u8D56\uFF0C\u6784\u5EFA\u7B49\u64CD\u4F5C</h4>`,9);function C(D,H){const a=i("ExternalLinkIcon");return d(),r("div",null,[h,e("blockquote",null,[e("p",null,[u,e("a",m,[g,n(a)]),b,v,k]),_,f,e("p",null,[y,e("a",w,[x,n(a)]),T]),q,I]),G,e("blockquote",null,[e("p",null,[N,e("a",V,[B,n(a)]),P,R,$,E,L]),S]),z])}const A=o(l,[["render",C],["__file","\u81EA\u52A8\u5316\u90E8\u7F72.html.vue"]]);export{A as default};
